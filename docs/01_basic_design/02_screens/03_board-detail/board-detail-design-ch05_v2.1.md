# 第5章: 掲示板詳細画面（コメントエリア設計）

**掲示板詳細画面 設計書 v2.1**

[← 第4章](board-detail-design-ch04_v2.1.md) | [目次に戻る](board-detail-design-ch00-index.md)

---

## 🆕 ChangeLog (v2.1 / 2025-10-31)

- 構成を再整理し、コメントエリアに関するUI/UX仕様のみに限定  
- 冗長なCSS・JS・テスト項目を削除  
- 翻訳仕様を更新（functional-requirements v1.3 に整合）  
- トーンを「やさしく・自然・控えめ」に統一  
- 将来拡張としてAIコメントサマリと通知連携構想を追加  
- ファイル名を正規形式（_full なし）で出力  

---

## 5.1 概要

本章は、掲示板詳細画面におけるコメントエリア（投稿への返信・意見記入領域）のUI/UX設計を定義する。  
対象は住民・管理組合の両方で利用可能なコメント機能であり、**テキスト投稿・編集・削除・翻訳**を基本操作とする。

本設計は、他章で定義されたUIトーン（「やさしく・自然・控えめ」）および多言語仕様に準拠する。

---

## 5.2 コメントカード構成

### 5.2.1 レイアウト概要

| 項目 | 内容 |
|------|------|
| 投稿者名 | 左上に表示。アイコン＋名前（例：👤 山田） |
| 投稿日時 | 投稿者名右側に小さく表示（例：2025/10/31 10:00） |
| 本文 | コメント内容（最大500文字）。改行保持。 |
| 翻訳ボタン | 本文下に小さく配置（「翻訳」） |
| 操作メニュー | 右上に三点メニュー（編集／削除） |
| 区切り線 | 各コメント間に薄いグレー線（#E0E0E0） |

**イメージ構成**
```
👤 山田　　2025/10/31 10:00
───────────────────
ごみ置き場の場所が少し分かりづらいですね。

[翻訳]　⋮
───────────────────
```

---

## 5.3 デザイン仕様

| 要素 | スタイル |
|------|----------|
| 背景 | #FFFFFF（白基調） |
| フォント | BIZ UDゴシック Regular |
| 本文文字色 | #333333 |
| 投稿日時 | #888888（12px） |
| 区切り線 | #E0E0E0（1px） |
| 翻訳ボタン | #1565C0（リンク色） |
| 三点メニュー | #666666 |
| シャドウ | なし（フラットデザイン） |
| 角丸 | 各カード上端8px / 下端0px（縦連続構造） |

UIはAppleカタログ風に余白を多く取り、コメント同士が圧迫感なく並ぶようにする。

---

## 5.4 操作仕様

### 5.4.1 投稿
- 入力欄は本文下部に固定配置。  
- プレースホルダー：「コメントを入力してください」  
- 投稿後は即時反映（ローカルキャッシュ → API送信）。  
- 投稿者名・日時は自動挿入。  

### 5.4.2 編集
- 投稿者本人のみが編集可能。  
- 編集時は本文が入力欄に展開され、「保存」「キャンセル」ボタンを表示。  
- 保存後、更新時刻を再表示。  

### 5.4.3 削除
- 投稿者本人または管理者のみ削除可。  
- 確認ダイアログ：「このコメントを削除しますか？」  
- 削除後はフェードアウト（0.3s）アニメーションで非表示化。  

### 5.4.4 翻訳（v2.1更新）
- 本文下に「翻訳」ボタンを配置。押下でAPIへ翻訳要求。  
- 結果は本文下に差し込みで展開（toggle式）。  
- Redisキャッシュキー形式：`translation:comment:{comment_id}:{lang}`  
- 翻訳済みの場合はキャッシュを優先。  

---

## 5.5 多言語対応

### 5.5.1 ラベル翻訳

| 日本語 | 英語 | 中国語 |
|--------|------|--------|
| コメントを入力してください | Enter a comment | 请输入评论 |
| 投稿 | Post | 发布 |
| 編集 | Edit | 编辑 |
| 削除 | Delete | 删除 |
| 翻訳 | Translate | 翻译 |

### 5.5.2 翻訳キャッシュ仕様

- Redis TTL：72時間（Phase1）  
- キャッシュ更新時はバックグラウンド再翻訳を非同期処理化（Phase2）  
- 翻訳文はユーザーごとのロケール設定に従って生成  

---

## 5.6 将来拡張（Phase2構想）

- コメントへのリアクション（👍 / ❤️ / 🙏）機能  
- AIによるコメントサマリ（要点抽出）表示  
- 管理組合コメントに対する「返信抑制」設定  
- 通知システムとの統合（コメント返信通知）  

---

## 5.7 UIトーン（共通指針）

- 「やさしく・自然・控えめ」を原則とし、文字・余白・配色の調和を優先。  
- 高齢層でも視認しやすいコントラストを確保。  
- ボタン・リンクは操作の意図が直感的に伝わる配置とする。  

---

**Document ID:** SEC-APP-BOARD-DETAIL-005-CH05  
**Created:** 2025-10-27  
**Last Updated:** 2025-10-31  
**Version:** 2.1  
