# 第1章: 概要と目的

**Document:** LOGIN画面 機能設計書 v1.0  
**Chapter:** 1 of 6  
**Last Updated:** 2025/10/27

---

## 1.1 ログイン機能の役割

ログイン機能は、SECUREA City スマートコミュニケーションアプリの**入口**として、以下の重要な役割を担います。

### 主要な役割

**セキュリティゲート**
- 正当なユーザーのみがアプリにアクセスできるよう制御
- 不正アクセスの防止
- ユーザー認証の実施

**テナント識別**
- マルチテナント環境における自治体・物件の識別
- 適切なデータベースへのアクセス制御
- テナントごとの設定・データの分離

**ユーザー体験の起点**
- シンプルで分かりやすい認証プロセス
- パスワードレス認証による利便性の向上
- 多言語対応による国際的な住民への配慮

**セキュアな認証基盤**
- マジックリンク方式によるセキュアな認証
- ワンタイムトークンによる不正利用防止
- 通信の暗号化（HTTPS）

---

## 1.2 マジックリンク認証方式の採用理由

本アプリでは、従来のID・パスワード方式ではなく、**マジックリンク認証方式**を採用しています。

### マジックリンク認証とは

**仕組み:**
```
1. ユーザーがメールアドレスとテナントIDを入力
2. システムがワンタイムトークン付きリンクをメール送信
3. ユーザーがメール内のリンクをクリック
4. 自動的にログイン完了
```

### 採用理由

**1. セキュリティの向上**
- パスワード不要 → パスワード漏洩リスクゼロ
- ワンタイムトークン → 使い回しによる不正ログイン防止
- 有効期限付き → 古いリンクは無効化

**2. ユーザビリティの向上**
- パスワード記憶不要 → 忘れるストレスがない
- パスワード設定不要 → 初回登録が簡単
- パスワードリセット不要 → サポート負荷の軽減

**3. 高齢者・外国人への配慮**
- 複雑なパスワードルール不要
- 言語による理解の壁を低減
- シンプルな操作フロー

**4. 管理コストの削減**
- パスワードリセット対応不要
- パスワードポリシー管理不要
- パスワード保存の暗号化対策が簡素化

### デメリットと対応策

| デメリット | 対応策 |
|-----------|--------|
| メールアクセスが必要 | メールアドレス登録時の確認徹底 |
| メール遅延の可能性 | 再送信機能の提供 |
| メール誤送信のリスク | テナントID確認による二重チェック |

---

## 1.3 マルチテナント対応

SECUREA City アプリは、複数の自治体・物件で利用されるため、**マルチテナント対応**が必須です。

### マルチテナントとは

**定義:**
- 1つのシステムで複数の独立した組織（テナント）が利用
- 各テナントのデータは完全に分離
- テナントごとに設定やカスタマイズが可能

**本アプリでの適用:**
- 各自治体・物件が1つのテナント
- テナントIDによる識別
- テナントごとに独立したデータベース領域

### テナントID形式

**形式:** `AABB99`（英字大文字4桁 + 数字2桁）

**構成:**
```
AA    : エリアコード（2桁、英字大文字）
BB    : ブランドコード（2桁、英字大文字）
99    : 地域コード（2桁、数字）
```

**例:**
```
TKSC01 → 東京エリア、セキュレアシティブランド、第1期
OSSC03 → 大阪エリア、セキュレアシティブランド、第3期
KWSC02 → 神奈川エリア、セキュレアシティブランド、第2期
```

**採用理由:**
- **スマートフォン最適化:** 記号なしで入力しやすい
- **適切な長さ:** 6文字は人間が記憶・入力可能な範囲
- **十分な組み合わせ数:** 676 × 676 × 100 = 45,697,600通り
- **拡張性:** 将来的な事業拡大に対応可能

### テナント識別の重要性

**セキュリティ:**
- テナント間のデータ漏洩防止
- 不正アクセスの防止
- 適切なデータベースへのアクセス制御

**運用:**
- テナントごとの設定管理
- テナントごとの利用統計
- テナントごとのサポート対応

---

## 1.4 設計の基本方針

ログイン機能の設計は、以下の4つの基本方針に基づいています。

### シンプル性

**設計意図:**
- 初めて使うユーザーでも迷わない、直感的なUI
- 最小限の入力項目（メールアドレス、テナントID）
- 明確な指示とフィードバック

**具体的な実装:**
- 入力項目は2つのみ
- プレースホルダーで入力例を表示
- エラーメッセージは分かりやすく

### セキュリティ

**設計意図:**
- 住民の個人情報を守る
- 不正アクセスを防ぐ
- セキュアな認証基盤の構築

**具体的な実装:**
- マジックリンク認証の採用
- ワンタイムトークンの使用
- レート制限による総当たり攻撃対策
- HTTPS通信の必須化

### ユーザビリティ

**設計意図:**
- ストレスフリーなログイン体験
- 高齢者や外国人にも使いやすい
- エラー時の適切なガイダンス

**具体的な実装:**
- パスワード不要
- スマートフォン最適化（記号なしのテナントID）
- 多言語対応（日本語、英語、中国語）
- 再送信機能の提供

### アクセシビリティ

**設計意図:**
- 誰もが平等にアクセスできる
- スクリーンリーダー対応
- キーボード操作のサポート

**具体的な実装:**
- セマンティックHTMLの使用
- ARIAラベルの適切な設定
- 十分なコントラスト比（WCAG 2.1 Level AA準拠）
- キーボードナビゲーション対応

---

## 1.5 対象ユーザー

### ユーザーペルソナ

**1. 日本人住民**
- 年齢層: 30代〜70代
- ITリテラシー: 初級〜中級
- ニーズ: 簡単で分かりやすい操作

**2. 外国人住民**
- 国籍: 主に英語圏、中国語圏
- 日本語レベル: 初級〜中級
- ニーズ: 母国語での利用、視覚的に分かりやすいUI

**3. 管理者**
- 役割: 自治会役員、管理会社スタッフ
- ITリテラシー: 中級〜上級
- ニーズ: セキュアで信頼性の高いシステム

### ユーザーシナリオ

**初回ログイン:**
```
1. 管理会社から送られたメールに記載された情報を確認
2. ログイン画面でメールアドレスとテナントIDを入力
3. メールボックスを確認してマジックリンクをクリック
4. 自動的にログインしてHOME画面へ
```

**2回目以降:**
```
1. ログイン画面でメールアドレスとテナントIDを入力
   （ブラウザの自動補完で入力が簡単）
2. メールボックスを確認してマジックリンクをクリック
3. 自動的にログインしてHOME画面へ
```

---

## 設計原則のまとめ

| 原則 | 重視する価値 | 実装への影響 |
|------|-------------|-------------|
| **シンプル性** | 使いやすさ | 最小限の入力項目、明確な指示 |
| **セキュリティ** | 安全性 | マジックリンク認証、レート制限 |
| **ユーザビリティ** | 快適さ | パスワードレス、多言語対応 |
| **アクセシビリティ** | 包括性 | スクリーンリーダー対応、WCAG準拠 |

---

**[次の章へ: 第2章 認証フローと画面構成 →](login-feature-design-v1_0-ch02.md)**

**[目次に戻る ↑](login-feature-design-ch00_index.md)**
