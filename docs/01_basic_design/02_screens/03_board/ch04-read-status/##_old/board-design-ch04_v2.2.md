# 第4章: 投稿詳細画面
**掲示板機能 詳細設計書 v2.2（HarmoNet準拠）**

[← 第3章](board-design-ch03_v2.3.md) | [目次に戻る](board-design-ch00-index_v2.0.md) | [第5章へ →](board-design-ch05_v2.1.md)

---

## 🆕 ChangeLog (v2.2 / 2025-10-31)
- 旧リンクを `board-feature-design-*` → `board-design-*` に修正  
- PDFプレビュー仕様（10/30要件）を追加  
- UIトーンをHarmoNet基準に統一（やさしく・自然・控えめ）  
- コード断片を削除し、文書層を純化  
- GPTレビューコメントを末尾に再配置  

---

## 4.1 画面概要

投稿詳細画面は、個別の投稿を閲覧・翻訳・コメント・添付閲覧を行う画面である。  
本文・添付ファイル・コメントを1画面に統合し、住民が情報を「読む・反応する」体験を中心に設計されている。

---

## 4.2 ヘッダー構成

### 要素
- 戻るボタン（一覧へ）  
- 三点メニュー（通報・編集・削除）  
- 共有ボタン（Phase 2で実装予定）  

### デザイン方針
ヘッダーは全画面共通の設計とし、`common-header_v1.1.md` を参照。  
余白を広く取り、タップ領域を確保。影や装飾は最小限。

---

## 4.3 投稿本文エリア

本文は最大2000文字まで全文表示され、URLや電話番号は自動リンク化される。  
翻訳ボタンは本文直下に配置され、ユーザーは1タップで母国語に切り替えられる。

**翻訳動作**
1. 「🌐 翻訳する」をタップ → 翻訳テキストを本文に置換表示。  
2. 再タップで原文に戻す。  

> 翻訳機能はGoogle Translation APIを利用。翻訳品質よりも「理解の手助け」として位置づける。  

---

## 4.4 添付ファイル表示エリア

添付ファイルは投稿本文の下部に配置される。  
画像・PDF・Office系ファイルを含めて最大5件まで表示可能。

### 画像ファイル
- サムネイル（120px × 120px）を横スクロールで表示。  
- タップでライトボックス（全画面プレビュー）を開く。  
- ピンチ操作で拡大・スワイプ移動可能。  

### PDFファイル（HarmoNet拡張仕様）

PDFファイルは以下の方式で表示する：

#### 表示方式
- ファイル名とアイコン（📄）を表示。  
- タップすると **モーダルウィンドウ** が開き、PDFをプレビュー表示。  
- PDF.js を利用して、ブラウザ内で直接表示（追加アプリ不要）。  

#### モーダル仕様
- 背景は半透明（#000000, opacity 0.5）  
- 画面上部右に「✕」アイコンを小さく表示  
- 画面下中央に「タップで閉じる」メッセージを表示  
- ユーザーがモーダル全体をタップすると閉じる  
- 背景タップでは閉じない（PDFスクロール操作を優先）  

#### メリット
- 追加アプリなしでPDF閲覧可能  
- スマートフォン・PCの両方で操作統一  
- UIの一貫性を保ち、安心感を与える  

### Officeファイル
- ファイル名・アイコンを表示し、タップでダウンロード。  
- Phase 2ではブラウザ内プレビュー（Google Docs Viewer互換）を検討。  

---

## 4.5 コメント表示エリア

コメントは投稿本文の下部に続いて表示され、1階層構造とする。  
翻訳ボタンは各コメント直下に配置され、投稿本文と同一動作。  

**表示要素**
| 項目 | 内容 |
|------|------|
| 投稿者名 | ニックネームまたは「管理組合」 |
| 投稿日時 | 日付＋時刻（例: 10/27 11:00） |
| 本文 | 最大500文字、改行対応 |
| 翻訳ボタン | 🌐 翻訳する／原文を表示 |

**返信仕様**
- 投稿が返信可能な場合、「コメントを入力...」欄を表示。  
- 返信不可投稿の場合、「この投稿には返信できません」をグレー背景で中央表示。  

---

## 4.6 既読状況エリア（回覧板のみ）

回覧板投稿に限り、「👁 既読状況」を表示する。  
既読人数／全体人数／割合をリアルタイム表示。

**操作仕様**
- 一般住民：未読 → 「既読にする」ボタンで状態変更。  
- 管理者：既読者一覧ボタンを表示（Phase 2対応）。  
- 操作後は「既読済み」表示に変更し、再送信不可。  

---

## 4.7 非機能要件

- PDFプレビューはPDF.jsを用いてlazy-load（遅延読み込み）する。  
- モーダル内スクロールはGPUアクセラレーションを使用。  
- 翻訳リクエストは1秒あたり最大3回に制限。  
- 添付5件以上は「他○件」として省略表示。  

---

## 4.8 設計意図まとめ

1. 投稿詳細画面を「読む体験」として再定義。  
2. 翻訳・ファイル閲覧をワンタップで完結できるUIに統一。  
3. PDFプレビューは“操作の安心感”を最優先に設計。  
4. デザイン全体でHarmoNetの「やさしく・自然・控えめ」理念を反映。  

---

## GPTレビュー要約コメント（再構成版）

> 第4章では、情報を「見る」から「読む」へと昇華させる設計思想が明確。  
> 特にPDFプレビューは、HarmoNetの“追加アプリ不要”哲学を体現しており、技術と体験の調和が取れている。  
> 全体を通じて、住民が安心して触れられるUI設計が貫かれている。  
> — *GPT上流設計レビュー担当（再編集）*

---

**Document ID:** SEC-APP-BOARD-DESIGN-002-CH04  
**Version:** 2.2  
**Created:** 2025-10-27  
**Last Updated:** 2025-10-31  
**Author:** TKD + GPT (HarmoNet PMO)  
