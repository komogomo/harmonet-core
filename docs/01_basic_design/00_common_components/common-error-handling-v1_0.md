\# 共通エラーハンドリング仕様書



| ドキュメントID | SEC-APP-COMMON-ERROR-001 |

| --- | --- |

| \*\*バージョン\*\* | \*\*v1.0\*\* |

| \*\*作成日\*\* | 2025年10月28日 |

| \*\*作成者\*\* | TKE + Gemini |

| \*\*承認者\*\* | (未定) |



---



\## 1. 概要



\### 1.1 目的

本ドキュメントは、HarmoNetアプリケーション全体における共通のエラーハンドリング仕様、特にAPI通信やシステムレベルのエラー発生時のUX（ユーザー体験）と表示メッセージを定義する。



\*\*画面固有のバリデーションエラー\*\*は、各画面の機能設計書に個別に定義すること。



\### 1.2 関連ドキュメント

| ドキュメント名 | 説明 |

| --- | --- |

| `common-security-v1\_0.md` | 共通セキュリティ要件 |

| `common-i18n.md` | 翻訳キーと多言語対応 |



---



\## 2. 共通APIエラー



APIからのデータ取得・送信時に発生するシステム共通のエラーUXを定義する。



| エラー種別 | 発生条件 | ユーザーへの表示 (UX) | i18n キー |

| --- | --- | --- | --- |

| \*\*通信失敗 (リトライ可)\*\* | サーバー接続失敗<br>通信タイムアウト<br>オフライン状態 | 1. \*\*メッセージ\*\*を表示<br>「通信エラーです。再試行してください。」<br><br>2. \*\*「再試行」ボタン\*\*を表示<br>(クリックでAPIを再実行) | `error.api.connectionFailed` |

| \*\*サーバーエラー (500系)\*\* | サーバー内部エラー (500, 503など) | 1. \*\*メッセージ\*\*を表示<br>「システムエラーが発生しました。時間をおいて再度お試しください。」<br><br>2. \*\*「HOMEへ戻る」ボタン\*\*を表示 | `error.api.serverError` |

| \*\*認証エラー (401)\*\* | セッション(JWT)切れ | 1. \*\*メッセージ\*\*を表示<br>「セッションが切れました。再度ログインしてください。」<br><br>2. \*\*自動でログイン画面へ遷移\*\*させる | `error.auth.sessionExpired` |

| \*\*権限エラー (403)\*\* | ユーザーにその操作の権限がない (例: 一般住民が管理者機能にアクセス) | 1. \*\*メッセージ\*\*を表示<br>「この操作を行う権限がありません。」<br><br>2. \*\*前の画面へ戻る\*\* | `error.auth.forbidden` |



---



\## Appendix C: 改訂履歴



| バージョン | 日付 | 更新者 | 更新内容 |

| --- | --- | --- | --- |

| v1.0 | 2025-10-28 | TKE + Gemini | 新規作成 |

