# 第3章：投稿本文エリアの詳細設計

**HarmoNET スマートコミュニケーションアプリ**  
**掲示板詳細画面 詳細設計書 v2.0**

---

## 目次

- [3.1 カテゴリバッジ](#31-カテゴリバッジ)
- [3.2 タイトル表示](#32-タイトル表示)
- [3.3 投稿者情報](#33-投稿者情報)
- [3.4 本文表示](#34-本文表示)
- [3.5 添付ファイル表示](#35-添付ファイル表示)
- [3.6 画像プレビュー機能](#36-画像プレビュー機能)
- [3.7 翻訳機能](#37-翻訳機能)
- [3.8 レスポンシブ対応](#38-レスポンシブ対応)
- [3.9 テスト項目](#39-テスト項目)

---

## 3.1 カテゴリバッジ

### 3.1.1 表示位置

- **配置**: タイトルの上、投稿本文エリアの最上部
- **余白**: 上部 `16px`、下部 `12px`

### 3.1.2 デザイン仕様

**基本スタイル**

```css
.category-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  line-height: 1.2;
}
```

**カテゴリ別の色設定**

| カテゴリ | 背景色 | テキスト色 | アイコン |
|---------|--------|-----------|---------|
| お知らせ（公式） | `#DBEAFE` | `#1E40AF` | 📣 |
| 質問・相談 | `#FEF3C7` | `#92400E` | ❓ |
| 雑談・交流 | `#E0E7FF` | `#3730A3` | 💬 |
| イベント | `#FCE7F3` | `#9F1239` | 🎉 |
| 不具合・修繕 | `#FEE2E2` | `#991B1B` | 🔧 |
| 駐車場・駐輪場 | `#D1FAE5` | `#065F46` | 🚗 |
| 宅配・ゴミ出し | `#FED7AA` | `#9A3412` | 📦 |
| 子育て情報 | `#FBCFE8` | `#9F1239` | 👶 |
| ペット関連 | `#E9D5FF` | `#6B21A8` | 🐾 |
| 周辺情報 | `#CCF3F8` | `#155E75` | 🏪 |

### 3.1.3 多言語対応

**カテゴリ名の翻訳**

カテゴリ名は、ユーザーの選択言語に応じて表示されます。

| 日本語 | 英語 | 中国語 |
|-------|------|--------|
| お知らせ | Announcement | 公告 |
| 質問・相談 | Q&A | 提问·咨询 |
| 雑談・交流 | Chat | 闲聊·交流 |
| イベント | Event | 活动 |
| 不具合・修繕 | Maintenance | 故障·维修 |

### 3.1.4 アイコン表示

- **位置**: カテゴリ名の左側
- **サイズ**: `16px × 16px`
- **絵文字**: Unicode絵文字を使用

---

## 3.2 タイトル表示

### 3.2.1 表示位置

- **配置**: カテゴリバッジの下
- **余白**: 上部 `12px`、下部 `16px`

### 3.2.2 テキストスタイル

```css
.post-title {
  font-size: 20px;
  font-weight: 700;
  line-height: 1.4;
  color: #111827;
  word-break: break-word;
}
```

### 3.2.3 制限事項

- **最大文字数**: 50文字
- **最大行数**: 制限なし（折り返し表示）
- **省略**: なし（全文表示）

### 3.2.4 レスポンシブ対応

| デバイス | フォントサイズ |
|---------|--------------|
| スマホ（〜767px） | `20px` |
| タブレット（768px〜1023px） | `22px` |
| デスクトップ（1024px〜） | `24px` |

---

## 3.3 投稿者情報

### 3.3.1 表示内容

**基本構成**

```
[アバター画像] ユーザー名 • 投稿日時 [編集済みマーク]
```

**表示例**

```
👤 田中太郎 • 2025/10/28 14:30
👤 あなた • 2025/10/28 14:30 (編集済み)
```

### 3.3.2 デザイン仕様

**コンテナ**

```css
.author-info {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
  font-size: 14px;
  color: #6B7280;
}
```

**アバター**

- **サイズ**: `32px × 32px`
- **形状**: 円形（`border-radius: 50%`）
- **デフォルト**: グレーの円に初期文字（例: 田中 → T）

**ユーザー名**

- **フォントサイズ**: `14px`
- **太字**: `font-weight: 600`
- **色**: `#374151`

**投稿日時**

- **フォーマット**: `YYYY/MM/DD HH:MM`
- **フォントサイズ**: `14px`
- **色**: `#9CA3AF`

**区切り文字**

- **記号**: `•`（中点）
- **色**: `#D1D5DB`

### 3.3.3 特殊表示

**自分の投稿**

- ユーザー名を「**あなた**」と表示
- 太字 + 青色（`#2563EB`）で強調

**編集済みマーク**

- 表示条件: 投稿が一度でも編集された場合
- テキスト: `(編集済み)` または `(Edited)` または `(已编辑)`
- 色: `#9CA3AF`
- フォントサイズ: `13px`

### 3.3.4 実名/ニックネーム表示

| 掲示板種別 | 表示名 |
|-----------|--------|
| 全体掲示板 | ニックネーム |
| グループ掲示板 | ニックネーム |
| 回覧板 | 実名（管理組合名義） |

---

## 3.4 本文表示

### 3.4.1 表示位置

- **配置**: 投稿者情報の下
- **余白**: 上部 `16px`、下部 `24px`

### 3.4.2 テキストスタイル

```css
.post-body {
  font-size: 16px;
  line-height: 1.7;
  color: #374151;
  white-space: pre-wrap;
  word-break: break-word;
}
```

### 3.4.3 改行の扱い

- **改行**: そのまま保持（`white-space: pre-wrap`）
- **空行**: 2行まで保持、3行以上は2行に変換
- **インデント**: 半角スペースはそのまま保持

### 3.4.4 URL自動リンク化

**対象**

- `http://` または `https://` で始まるURL
- `www.` で始まるURL（自動的に `https://` を付与）

**スタイル**

```css
.post-body a {
  color: #2563EB;
  text-decoration: underline;
  word-break: break-all;
}
```

**動作**

- タップでブラウザを開く
- 外部リンク警告を表示（Phase 2）

### 3.4.5 絵文字表示

- **対応**: Unicode絵文字をサポート
- **サイズ**: テキストと同じサイズで表示
- **例**: 😊 👍 ❤️ 🎉

### 3.4.6 最大文字数

- **制限**: 2000文字
- **超過時**: 投稿画面でエラー表示

---

## 3.5 添付ファイル表示

### 3.5.1 表示位置

- **配置**: 本文の下
- **余白**: 上部 `24px`、下部 `24px`

### 3.5.2 レイアウト

**複数ファイルの場合**

- **配置**: 横スクロール
- **間隔**: 各ファイル間に `12px`
- **最大表示数**: 5ファイル

### 3.5.3 画像ファイルの表示

**サムネイル仕様**

```css
.attachment-image {
  width: 100%;
  max-width: 600px;
  height: auto;
  border-radius: 8px;
  object-fit: cover;
}
```

**表示形式**

- **1枚の場合**: 全幅表示（最大600px）
- **2枚の場合**: 2列グリッド
- **3枚以上**: 横スクロール

### 3.5.4 PDF・Officeファイルの表示

**デザイン**

```css
.attachment-file {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background-color: #F9FAFB;
  border: 1px solid #E5E7EB;
  border-radius: 8px;
  cursor: pointer;
}
```

**表示内容**

```
[アイコン] ファイル名.pdf
           512 KB
           [ダウンロード]
```

**アイコン**

| ファイル種類 | アイコン | 色 |
|-------------|---------|-----|
| PDF | 📄 | `#DC2626` |
| Word (.docx) | 📝 | `#2563EB` |
| Excel (.xlsx) | 📊 | `#059669` |
| PowerPoint (.pptx) | 📽️ | `#DC2626` |

### 3.5.5 ダウンロード動作

**動作フロー**

1. ファイルカードをタップ
2. ローディング表示（`ダウンロード中...`）
3. ファイルダウンロード開始
4. 完了後、トースト通知表示（`ダウンロードが完了しました`）

**エラー処理**

- **ネットワークエラー**: `ネットワークエラーです。接続を確認してください。`
- **ファイルなし**: `ファイルが見つかりませんでした。`

---

## 3.6 画像プレビュー機能

### 3.6.1 ライトボックス表示

**トリガー**

- 画像をタップすると、全画面表示モード（ライトボックス）を開く

**デザイン**

```css
.lightbox {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.9);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
}
```

### 3.6.2 操作方法

**ピンチイン・アウト**

- 2本指で拡大・縮小
- 最小: 50%
- 最大: 300%

**スワイプ**

- 左右スワイプで前後の画像に移動
- 複数画像がある場合のみ有効

**閉じる**

- 画像外をタップ
- 「×」ボタンをタップ
- 戻るボタンをタップ

### 3.6.3 画像情報表示

**表示内容**

```
[← →] 1 / 3
[×]
```

- **左矢印**: 前の画像へ
- **右矢印**: 次の画像へ
- **ページ番号**: 現在の画像位置 / 全画像数
- **閉じるボタン**: 右上に配置

---

## 3.7 翻訳機能

### 3.7.1 翻訳ボタン配置

**位置**

- 本文の下、添付ファイルの上
- 右寄せ配置

**デザイン**

```css
.translate-button {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  background-color: #FFFFFF;
  border: 1px solid #D1D5DB;
  border-radius: 6px;
  font-size: 14px;
  color: #374151;
  cursor: pointer;
}
```

**テキスト**

- 翻訳前: `翻訳` または `Translate` または `翻译`
- 翻訳後: `元の言語に戻す` または `Show Original` または `显示原文`

**アイコン**

- 🌐（地球アイコン）

### 3.7.2 翻訳処理

**翻訳API**

- Google Translation API（Basic v2）を使用

**翻訳フロー**

```
ユーザーが翻訳ボタンをタップ
  ↓
[翻訳中...] 表示（0.5秒）
  ↓
APIに翻訳リクエスト送信
  ↓
翻訳結果を受信
  ↓
本文を翻訳後の文章に置き換え
  ↓
翻訳済みマーク表示
  ↓
ボタンラベルを「元の言語に戻す」に変更
```

**翻訳キャッシュ**

- 同じ本文の翻訳は一度だけ実行
- ローカルストレージに保存
- キャッシュの有効期限: 24時間

**翻訳言語の決定**

- ユーザーの選択言語に翻訳
- 例: 日本語選択中 → 英語投稿を日本語に翻訳

### 3.7.3 翻訳済み表示

**翻訳済みマーク**

- 位置: 本文の上部
- テキスト: `翻訳済み（原文: 日本語）`
- スタイル: 薄いグレー背景、小さめフォント

**CSS**

```css
.translated-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 12px;
  background-color: #F3F4F6;
  color: #6B7280;
  border-radius: 4px;
  font-size: 12px;
  margin-bottom: 12px;
}
```

### 3.7.4 元の言語に戻す

**動作**

1. 「元の言語に戻す」ボタンをタップ
2. 本文を元のテキストに戻す
3. 翻訳済みマークを削除
4. ボタンラベルを「翻訳」に戻す

**アニメーション**

- フェードイン・アウト（200ms）

### 3.7.5 エラーハンドリング

**翻訳失敗時**

- エラーメッセージ: `翻訳に失敗しました。もう一度お試しください。`
- 表示位置: ボタンの下にトースト表示
- 自動消去: 3秒後

**ネットワークエラー時**

- エラーメッセージ: `ネットワークエラーです。接続を確認してください。`

---

## 3.8 レスポンシブ対応

### 3.8.1 スマホ（〜767px）

**余白**

- 左右余白: `24px`
- 上下余白: `24px`

**フォントサイズ**

- タイトル: `20px`
- 本文: `16px`
- 投稿者情報: `14px`

**画像**

- 幅: `100%`
- 最大高さ: `300px`

### 3.8.2 タブレット（768px〜1023px）

**余白**

- 左右余白: `32px`
- 上下余白: `32px`

**フォントサイズ**

- タイトル: `22px`
- 本文: `16px`

**画像**

- 幅: `100%`
- 最大高さ: `400px`

### 3.8.3 デスクトップ（1024px〜）

**余白**

- 左右余白: `48px`（最大幅800px内で）
- 上下余白: `32px`

**フォントサイズ**

- タイトル: `24px`
- 本文: `16px`

**画像**

- 幅: `100%`
- 最大高さ: `500px`

---

## 3.9 テスト項目

### 3.9.1 表示テスト

**カテゴリバッジ**

- ✅ カテゴリごとに正しい色で表示
- ✅ アイコンが表示される
- ✅ 多言語で正しく表示

**タイトル**

- ✅ 太字で大きく表示
- ✅ 長文でも折り返し表示
- ✅ 50文字制限を超えない

**投稿者情報**

- ✅ 投稿者名と日時が表示
- ✅ 自分の投稿は「あなた」表示
- ✅ 日時形式が正しい

**本文**

- ✅ 改行が保持される
- ✅ URLが自動リンク化
- ✅ 絵文字が表示される

**添付ファイル**

- ✅ 画像がプレビュー表示
- ✅ PDFがダウンロードリンク表示
- ✅ Officeファイルがダウンロードリンク表示

**翻訳ボタン**

- ✅ 翻訳ボタンが表示
- ✅ 翻訳済みマークが表示
- ✅ 元の言語に戻せる

### 3.9.2 機能テスト

**画像拡大**

- ✅ タップで画像が拡大表示
- ✅ ピンチで拡大縮小
- ✅ スワイプで次の画像へ

**ファイルダウンロード**

- ✅ ダウンロードボタンでファイル取得
- ✅ ローディング表示される
- ✅ 完了後トースト通知

**翻訳**

- ✅ 翻訳ボタンで本文が翻訳される
- ✅ 翻訳済みマークが表示される
- ✅ 元の言語に戻せる
- ✅ エラー時にメッセージ表示

### 3.9.3 レスポンシブテスト

**スマホ**

- ✅ 余白が適切
- ✅ フォントサイズが適切
- ✅ 画像が画面幅に収まる

**タブレット**

- ✅ 余白が増える
- ✅ フォントサイズが大きくなる

**デスクトップ**

- ✅ 最大幅800pxで表示
- ✅ 中央揃え

---

## 🔗 関連ドキュメント

### 前後の章

- [第2章: ヘッダー領域](board-detail-design-ch02_v2_0.md)
- [第4章: 既読状況エリア](board-detail-design-ch04_v2_0.md)

### 共通仕様

- `common-i18n_v1_0.md` - 翻訳機能の共通仕様

### デザインシステム

- `harmonet-design-system_v1_0.md` - HarmoNET Design System

---

**Document ID:** HRM-APP-BOARD-DETAIL-DESIGN-001-CH03  
**Version:** 2.0  
**Status:** 承認待ち  
**Created:** 2025-10-29  
**Last Updated:** 2025-10-29  
**Approved by:** _未承認_

---

**HarmoNET スマートコミュニケーションアプリ**  
掲示板詳細画面 詳細設計書 v2.0 - 第3章
